test_cl_signatures (__main__.TestSPARKProtocol.test_cl_signatures)
Verify CL signatures for Edge and IoT credentials. ... ERROR
test_curve (__main__.TestSPARKProtocol.test_curve)
Verify BN254 curve is used. ... ERROR
test_elgamal_tokens (__main__.TestSPARKProtocol.test_elgamal_tokens)
Verify ElGamal tracing tokens by decryption. ... ok
test_group_elements (__main__.TestSPARKProtocol.test_group_elements)
Verify group elements belong to correct BN254 groups. ... ERROR
test_schnorr_proofs (__main__.TestSPARKProtocol.test_schnorr_proofs)
Verify Schnorr proofs for all public keys. ... ok
test_tpm_signatures (__main__.TestSPARKProtocol.test_tpm_signatures)
Verify simulated TPM signatures. ... ERROR
test_variables (__main__.TestSPARKProtocol.test_variables)
Ensure all variables from Sections 7.1 and 7.2 are present. ... ok

======================================================================
ERROR: test_cl_signatures (__main__.TestSPARKProtocol.test_cl_signatures)
Verify CL signatures for Edge and IoT credentials.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/novie/Code/Secure-CAN_Attestation-Protocol/Secure-CAN_Attestation-Protocol/test_spark.py", line 84, in test_cl_signatures
    left = pair(A, pair(G, issuer.public_key['X_tilde']) + ks['G_tilde'])
                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~
SystemError: error return without exception set

======================================================================
ERROR: test_curve (__main__.TestSPARKProtocol.test_curve)
Verify BN254 curve is used.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/novie/Code/Secure-CAN_Attestation-Protocol/Secure-CAN_Attestation-Protocol/test_spark.py", line 22, in test_curve
    self.assertEqual(PAIRING_GROUP.curve, 'BN254', "Curve is not BN254")
                     ^^^^^^^^^^^^^^^^^^^
AttributeError: 'PairingGroup' object has no attribute 'curve'

======================================================================
ERROR: test_group_elements (__main__.TestSPARKProtocol.test_group_elements)
Verify group elements belong to correct BN254 groups.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/novie/Code/Secure-CAN_Attestation-Protocol/Secure-CAN_Attestation-Protocol/test_spark.py", line 32, in test_group_elements
    self.assertTrue(ks['G0'] in G1, "G0 not in G1")
                    ^^^^^^^^^^^^^^
TypeError: argument of type 'int' is not iterable

======================================================================
ERROR: test_tpm_signatures (__main__.TestSPARKProtocol.test_tpm_signatures)
Verify simulated TPM signatures.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/novie/Code/Secure-CAN_Attestation-Protocol/Secure-CAN_Attestation-Protocol/test_spark.py", line 125, in test_tpm_signatures
    self.assertTrue(verify_schnorr_proof(edge.public_key, G, edge.credential['tpm_signature']),
                                                             ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
KeyError: 'tpm_signature'

----------------------------------------------------------------------
Ran 7 tests in 4.649s

FAILED (errors=4)
